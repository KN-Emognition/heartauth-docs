flowchart TB
    start([Start]):::startEnd
    created([Created]):::startEnd
    pending([Pending])
    decision{{Key validation}}:::decision
    approved([Approved]):::terminal
    denied([Denied]):::error
    expired([Expired]):::expired
    notfound([Not&nbsp;Found]):::tech
    finish((End)):::startEnd

    start --> created 
    created -->|initialized by user| pending
    pending -->|completed by user| decision
    pending -->|reinitialized by user| denied
    decision -->|verification successful| approved
    decision -->|verification failed| denied

    created -.->|TTL / timeout| expired
    pending -.->|TTL / timeout| expired
    approved -.->|retention cleanup| expired
    denied -.->|retention cleanup| expired

    expired --> finish

    start -.->|lookup: missing key| notfound


